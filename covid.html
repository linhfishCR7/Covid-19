<!doctype html>
<html lang="en">

<head>
    <title>Covid-19</title>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css"
        integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
    <link rel="stylesheet" href="./Bootstrap-4-Chosen-Plugin/dist/css/component-chosen.min.css">
    <link rel="stylesheet" href="./icofont/icofont.min.css">
    <!-- Custom styles for this page -->
    <!-- <link href="https://cdn.datatables.net/1.10.25/css/jquery.dataTables.min.css" rel="stylesheet"> -->
    <!-- <script>
        $(document).ready(function () {
                // debugger;
                $('#covid').DataTable();
            });
    </script> -->
</head>

<body>
    <div class="container-fluid mt-2">
        <h1 class="text-center">THỐNG KÊ SỐ LIỆU COVID-19</h1>
        <legend>
            <fieldset>THỐNG KÊ THEO QUỐC GIA</fieldset>
            <div style="text-align: center;">
                <img class="img-fluid" id="flag">
                <h2 id="country"></h2>
            </div>

            <form>
                <div class="form-group">
                    <label for="country1">Chọn Quốc Gia</label>
                    <select id="country1" class="form-control form-control-chosen" data-placeholder="Please select...">
                        <!-- <option value="vietnam">Viet Nam</option>
                        <option value="japan">Japan</option>
                        <option value="Laos">Laos</option> -->
                    </select>
                </div>
                <div class="mt-2">
                    <button id="btn" class="btn-primary btn">Submit</button>

                </div>
            </form>
            <div class="row mt-2">
                <div class="col-md-4 mt-2">
                    <div class="card text-white bg-danger">
                        <img class="card-img-top" src="holder.js/100px180/" alt="">
                        <div class="card-body">
                            <h4 class="card-title"><i class="icofont-close-squared"></i> Tổng Số Ca</h4>
                            <p class="card-text" id="cases"></p>
                        </div>
                    </div>
                </div>
                <div class="col-md-4 mt-2">
                    <div class="card text-white bg-success">
                        <img class="card-img-top" src="holder.js/100px180/" alt="">
                        <div class="card-body">
                            <h4 class="card-title"><i class="icofont-checked"></i> Số Ca Khỏi Bệnh</h4>
                            <p class="card-text" id="recovered"></p>

                        </div>
                    </div>
                </div>
                <div class="col-md-4 mt-2">
                    <div class="card text-white bg-warning">
                        <img class="card-img-top" src="holder.js/100px180/" alt="">
                        <div class="card-body">
                            <h4 class="card-title"><i class="icofont-danger-zone"></i> Tổng Số Ca Chết</h4>
                            <p class="card-text" id="deaths"></p>

                        </div>
                    </div>
                </div>
            </div>
            <div class="row mt-5">
                <div class="col-md-4 mt-2">
                    <div class="card text-white bg-danger">
                        <img class="card-img-top" src="holder.js/100px180/" alt="">
                        <div class="card-body">
                            <h4 class="card-title"><i class="icofont-close-squared"></i> Số Ca Hôm Nay</h4>
                            <p class="card-text" id="todayCases"></p>

                        </div>
                    </div>
                </div>

                <div class="col-md-4 mt-2">
                    <div class="card text-white bg-success">
                        <img class="card-img-top" src="holder.js/100px180/" alt="">
                        <div class="card-body">
                            <h4 class="card-title"><i class="icofont-checked"></i> Tổng Số Ca Khỏi Bệnh Hôm Nay</h4>
                            <p class="card-text" id="todayRecovered"></p>

                        </div>
                    </div>
                </div>

                <div class="col-md-4 mt-2">
                    <div class="card text-white bg-warning">
                        <img class="card-img-top" src="holder.js/100px180/" alt="">
                        <div class="card-body">
                            <h4 class="card-title"><i class="icofont-danger-zone"></i> Tổng Số Ca Chết Hôm Nay</h4>
                            <p class="card-text" id="todayDeaths"></p>
                        </div>
                    </div>
                </div>
            </div>
        </legend>
        <legend class="mt-5">
            <fieldset>TẤT CẢ CÁC QUỐC GIA</fieldset>
            <div class="row mt-5">
                <div class="col-md-12">
                    <div class="d-flex justify-content-center">
                        <div class="spinner-border" role="status" id="loading">
                            <span class="sr-only">Loading...</span>
                        </div>
                    </div>
                    <table id="covid" class="table table-striped table-responsive"></table>
                </div>
            </div>
        </legend>

    </div>

    <!-- Optional JavaScript -->
    <!-- jQuery first, then Popper.js, then Bootstrap JS -->
    <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js"
        integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo"
        crossorigin="anonymous"></script>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js"
        integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1"
        crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"
        integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM"
        crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/chosen/1.8.6/chosen.jquery.min.js"></script>
    <!-- Page level plugins -->
    <!-- <script src="https://code.jquery.com/jquery-3.5.1.js"></script>
    <script src="https://cdn.datatables.net/1.10.25/js/jquery.dataTables.min.js"></script> -->

    <!-- Page level custom scripts -->
    
    <!-- <script src="https://cdn.jsdelivr.net/npm/apexcharts"></script> -->


    <script>

        // api url
        const api_url =
            "https://disease.sh/v3/covid-19/countries";

        // Defining async function
        async function getapi(url) {

            // Storing response
            const response = await fetch(url);

            // Storing data in form of JSON
            var data = await response.json();
            console.log(data);
            if (response) {
                hideloader();
            }
            show(data);
            showcountry(data);
        }
        // Calling that async function
        getapi(api_url);

        // Function to hide the loader
        function hideloader() {
            document.getElementById('loading').style.display = 'none';
        }
        
        // Function to define innerHTML for HTML table
        function show(data) {

            let tab =
                `<thead>
                    <tr>
                        <th>Quốc Gia</th>
                        <th>Tổng Số Ca</th>
                        <th>Số Ca Hôm Nay</th>
                        <th>Tổng Số Ca Chết </th>
                        <th>Tổng Số Ca Chết Hôm Nay</th>
                        <th>Số Ca Khỏi Bệnh</th>
                        <th>Số Ca Khỏi Bệnh Hôm Nay</th>
                    </tr>  
                </thead>`;

            // Loop to access all rows 
            for (let r of data) {
                tab += `<tbody>
                            <tr> 
                                <td>${r.country} </td>
                                <td>${r.cases}</td>
                                <td>${r.todayCases}</td>
                                <td>${r.deaths}</td>
                                <td>${r.todayDeaths}</td>
                                <td>${r.recovered}</td>
                                <td>${r.todayRecovered}</td>
                            </tr>
                        </tbody>`;
            }
            // Setting innerHTML as tab variable
            document.getElementById("covid").innerHTML = tab;
            
        }

        function showcountry(data) {
            let tab;
            // Loop to access all rows 
            for (let r of data) {
                tab += `<option value ="` + `${r.country}"` + `>${r.country}
                </option>`;
            }
            // Setting innerHTML as tab variable
            document.getElementById("country1").innerHTML = tab;
            const btn = document.querySelector('#btn');
            const sb = document.querySelector('#country1')
            btn.onclick = (event) => {
                event.preventDefault();
                // show the selected index
                // alert(sb.selectedIndex);
                fetch('https://disease.sh/v3/covid-19/countries/' + sb.value)
                    .then((response) => {
                        return response.json();
                    }).then((data) => {
                        document.getElementById("flag").src = data.countryInfo.flag;
                        document.getElementById("country").innerHTML = data.country;
                        document.getElementById("cases").innerHTML = data.cases;
                        document.getElementById("todayCases").innerHTML = data.todayCases;
                        document.getElementById("deaths").innerHTML = data.deaths;
                        document.getElementById("todayDeaths").innerHTML = data.todayDeaths;
                        document.getElementById("recovered").innerHTML = data.recovered;
                        document.getElementById("todayRecovered").innerHTML = data.todayRecovered;
                    })
            };
            $('.form-control-chosen').chosen({
                // Chosen options here
            });

        }

    </script>
</body>

</html>